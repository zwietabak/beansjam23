[gd_scene load_steps=16 format=3 uid="uid://deeryhksmvs2m"]

[ext_resource type="Script" path="res://enemy/enemy_controller.gd" id="1_pi25j"]
[ext_resource type="Script" path="res://enemy/enemy_sound_effects.gd" id="2_jaulv"]
[ext_resource type="Script" path="res://enemy/enemy_walking_sounds.gd" id="3_ruucy"]
[ext_resource type="AudioStream" uid="uid://c46xfjlsommfp" path="res://audio/sound_files/monster/Monster_Footsteps.mp3" id="3_wgj4f"]
[ext_resource type="PackedScene" uid="uid://dgyo2xln80eos" path="res://enemy/enemy_mesh.tscn" id="5_bficc"]
[ext_resource type="Script" path="res://StateMachines/Enemy/Enemy_State_Machine.gd" id="6_rfg1c"]
[ext_resource type="Script" path="res://StateMachines/Enemy/States/Enemy_Idle.gd" id="7_y3mie"]
[ext_resource type="Script" path="res://StateMachines/Enemy/States/Enemy_Follow.gd" id="8_27t0j"]
[ext_resource type="Script" path="res://StateMachines/Enemy/States/Enemy_Attack.gd" id="9_keaip"]
[ext_resource type="Script" path="res://StateMachines/Enemy/States/Enemy_Retreat.gd" id="10_2u20i"]
[ext_resource type="Script" path="res://enemy/Enemy_Inactive.gd" id="11_rwiur"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_x8y0j"]

[sub_resource type="BoxShape3D" id="BoxShape3D_m7tor"]
size = Vector3(1, 2, 1)

[sub_resource type="SphereShape3D" id="SphereShape3D_164af"]
radius = 23.8479

[sub_resource type="BoxShape3D" id="BoxShape3D_3c80v"]
size = Vector3(1, 1.5, 0.5)

[node name="Enemy" type="CharacterBody3D" node_paths=PackedStringArray("sound_effects", "walking_sound") groups=["enemy"]]
script = ExtResource("1_pi25j")
sound_effects = NodePath("EnemySoundEffects")
walking_sound = NodePath("EnemyWalkingSounds")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_x8y0j")

[node name="Hitbox" type="Area3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)

[node name="CollisionShape3D" type="CollisionShape3D" parent="Hitbox"]
shape = SubResource("BoxShape3D_m7tor")

[node name="Player_Detection" type="Area3D" parent="."]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Player_Detection"]
shape = SubResource("SphereShape3D_164af")

[node name="Damage_Detection" type="Area3D" parent="."]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Damage_Detection"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, -0.75)
shape = SubResource("BoxShape3D_3c80v")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
path_height_offset = 0.5

[node name="Face_Direction" type="Node3D" parent="."]

[node name="EnemySoundEffects" type="AudioStreamPlayer3D" parent="."]
max_polyphony = 3
bus = &"SoundEffects"
script = ExtResource("2_jaulv")

[node name="EnemyWalkingSounds" type="AudioStreamPlayer3D" parent="."]
stream = ExtResource("3_wgj4f")
pitch_scale = 1.4
bus = &"SoundEffects"
script = ExtResource("3_ruucy")

[node name="Enemy_Mesh" parent="." instance=ExtResource("5_bficc")]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)

[node name="Skeleton3D" parent="Enemy_Mesh/Armature" index="0"]
bones/0/position = Vector3(0.190674, 0.442437, -97.5607)
bones/0/rotation = Quaternion(-0.725242, -0.0118844, -0.00791287, 0.688346)
bones/1/rotation = Quaternion(-0.0479271, -0.00201514, 0.00170691, 0.998847)
bones/2/rotation = Quaternion(0.0158517, -0.0275957, 0.000564347, 0.999493)
bones/3/rotation = Quaternion(0.0733806, -0.027479, 0.00296876, 0.996921)
bones/4/rotation = Quaternion(0.0177988, 0.0164134, -0.0056851, 0.999691)
bones/5/rotation = Quaternion(0.0689309, -0.000331348, 0.0426334, 0.99671)
bones/6/rotation = Quaternion(-0.444656, -0.550821, 0.574886, -0.410346)
bones/7/rotation = Quaternion(0.528466, 0.250662, 0.234287, 0.776532)
bones/8/rotation = Quaternion(4.4748e-07, -2.54717e-07, 0.263802, 0.964577)
bones/9/rotation = Quaternion(0.089652, 0.0145626, -0.117593, 0.9889)
bones/10/rotation = Quaternion(0.174006, -0.0865334, 0.118142, 0.973795)
bones/11/rotation = Quaternion(-0.0232125, -0.000100621, -0.125035, 0.991881)
bones/12/rotation = Quaternion(-0.0254352, 0.000229626, -0.00621487, 0.999657)
bones/13/rotation = Quaternion(0.190816, -0.00489313, 0.000908703, 0.981613)
bones/14/rotation = Quaternion(0.327547, -0.000202909, -0.0401134, 0.943983)
bones/15/rotation = Quaternion(0.095129, 0.000290867, -0.00843353, 0.995429)
bones/16/rotation = Quaternion(0.240349, 0.00218705, -0.0268356, 0.970313)
bones/17/rotation = Quaternion(0.222967, -0.00125393, -0.0323869, 0.974287)
bones/18/rotation = Quaternion(0.0724859, 2.08452e-05, -0.00846077, 0.997334)
bones/19/rotation = Quaternion(0.318809, 0.00146125, -0.0283667, 0.947393)
bones/20/rotation = Quaternion(0.119058, -0.000629738, -0.0196217, 0.992693)
bones/21/rotation = Quaternion(0.0292777, -7.71105e-05, -0.0061667, 0.999552)
bones/22/rotation = Quaternion(0.346655, 0.00414835, -0.0630326, 0.935863)
bones/23/rotation = Quaternion(0.177315, 0.00752685, 0.0212348, 0.983896)
bones/25/rotation = Quaternion(0.512255, -0.50937, 0.525125, 0.449868)
bones/26/rotation = Quaternion(0.520774, -0.199517, -0.221553, 0.799938)
bones/27/rotation = Quaternion(1.98723e-07, 4.57548e-08, -0.269468, 0.963009)
bones/28/rotation = Quaternion(-0.00856895, 0.0401404, 0.130594, 0.990586)
bones/29/rotation = Quaternion(0.176883, 0.0455622, -0.107147, 0.977321)
bones/30/rotation = Quaternion(-0.00495328, -0.033866, 0.10862, 0.993494)
bones/31/rotation = Quaternion(-0.0295053, -0.000822526, 0.0018097, 0.999563)
bones/32/rotation = Quaternion(0.0863586, -0.00285768, 0.0423161, 0.995361)
bones/33/rotation = Quaternion(0.33551, 1.51315e-06, 0.0408915, 0.941149)
bones/34/rotation = Quaternion(0.0730842, 1.84733e-07, 0.0089066, 0.997286)
bones/35/rotation = Quaternion(0.144146, -0.00136604, 0.0278861, 0.989163)
bones/36/rotation = Quaternion(0.294384, 2.44357e-07, 0.0358759, 0.955014)
bones/37/rotation = Quaternion(0.0612447, 0.00739262, 0.00787394, 0.998064)
bones/38/rotation = Quaternion(0.211142, 0.00517202, 0.0035838, 0.977435)
bones/39/rotation = Quaternion(0.227721, 1.88676e-06, 0.0277598, 0.973331)
bones/40/rotation = Quaternion(0.0492041, 0.0088503, 0.00640196, 0.998729)
bones/41/rotation = Quaternion(0.268295, 0.0117155, -0.0102528, 0.963211)
bones/42/rotation = Quaternion(0.204106, 2.39481e-06, 0.0248842, 0.978632)
bones/43/rotation = Quaternion(0.0297628, -3.93898e-07, 0.00361645, 0.99955)
bones/44/rotation = Quaternion(0.0393334, 0.0749034, 0.995686, -0.0380965)
bones/45/rotation = Quaternion(-0.240934, -0.076271, 0.0198879, 0.967336)
bones/46/rotation = Quaternion(0.630181, -0.0373722, 0.00407499, 0.775538)
bones/47/rotation = Quaternion(0.2296, -0.0325163, -0.0153308, 0.972621)
bones/48/rotation = Quaternion(-0.095051, 0.0628654, 0.992795, 0.0370256)
bones/49/rotation = Quaternion(-0.203354, 0.0294875, -0.0123354, 0.978583)
bones/50/rotation = Quaternion(0.607164, 0.0260337, 0.0155672, 0.793997)
bones/51/rotation = Quaternion(0.227466, 0.032585, 0.015379, 0.973119)

[node name="BoneAttachment3D" parent="Enemy_Mesh/Armature/Skeleton3D" index="2"]
transform = Transform3D(0.992947, -0.0853647, -0.0822728, 0.0975788, 0.194294, 0.976078, -0.0673375, -0.977222, 0.201254, 0.880188, 0.523378, -157.458)

[node name="BoneAttachment3D2" parent="Enemy_Mesh/Armature/Skeleton3D" index="3"]
transform = Transform3D(0.513659, 0.283741, -0.80972, -0.846045, 0.0105436, -0.533008, -0.142699, 0.958843, 0.245473, 19.838, -4.83334, -140.684)

[node name="BoneAttachment3D4" parent="Enemy_Mesh/Armature/Skeleton3D" index="4"]
transform = Transform3D(0.402199, -0.305175, 0.863195, 0.908429, 0.0156372, -0.417747, 0.113988, 0.952168, 0.283519, -17.6822, -6.80796, -140.626)

[node name="BoneAttachment3D3" parent="Enemy_Mesh/Armature/Skeleton3D" index="5"]
transform = Transform3D(-0.969651, 0.0149584, 0.244035, 0.229912, -0.283748, 0.930928, 0.0831696, 0.958782, 0.271697, 11.2868, 8.82317, -50.92)

[node name="BoneAttachment3D5" parent="Enemy_Mesh/Armature/Skeleton3D" index="6"]
transform = Transform3D(-0.960254, -0.0424667, -0.275879, -0.259051, -0.232483, 0.937467, -0.103948, 0.971673, 0.212241, -13.7395, 7.52112, -51.4175)

[node name="EnemyStateMachine" type="Node" parent="."]
script = ExtResource("6_rfg1c")
initial_state = NodePath("Inactive")

[node name="Idle" type="Node" parent="EnemyStateMachine"]
script = ExtResource("7_y3mie")

[node name="Follow" type="Node" parent="EnemyStateMachine"]
script = ExtResource("8_27t0j")

[node name="Attack" type="Node" parent="EnemyStateMachine"]
script = ExtResource("9_keaip")

[node name="Retreat" type="Node" parent="EnemyStateMachine"]
script = ExtResource("10_2u20i")

[node name="Inactive" type="Node" parent="EnemyStateMachine"]
script = ExtResource("11_rwiur")

[connection signal="attack" from="." to="Enemy_Mesh/AnimationTree" method="SetAttack"]
[connection signal="attack2" from="." to="Enemy_Mesh/AnimationTree" method="SetAttack2"]
[connection signal="on_died" from="." to="Enemy_Mesh/AnimationTree" method="Kill"]
[connection signal="running" from="." to="Enemy_Mesh/AnimationTree" method="SetRunning"]
[connection signal="animation_signal" from="Enemy_Mesh" to="." method="_on_enemy_mesh_animation_signal"]
[connection signal="animation_finished" from="Enemy_Mesh/AnimationTree" to="." method="_on_anim_finished"]

[editable path="Enemy_Mesh"]
