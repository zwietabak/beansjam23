[gd_scene load_steps=16 format=3 uid="uid://deeryhksmvs2m"]

[ext_resource type="Script" path="res://enemy/enemy_controller.gd" id="1_pi25j"]
[ext_resource type="Script" path="res://enemy/enemy_sound_effects.gd" id="2_jaulv"]
[ext_resource type="Script" path="res://enemy/enemy_walking_sounds.gd" id="3_ruucy"]
[ext_resource type="PackedScene" uid="uid://dgyo2xln80eos" path="res://enemy/enemy_mesh.tscn" id="5_bficc"]
[ext_resource type="Script" path="res://StateMachines/Enemy/Enemy_State_Machine.gd" id="6_rfg1c"]
[ext_resource type="Script" path="res://StateMachines/Enemy/States/Enemy_Idle.gd" id="7_y3mie"]
[ext_resource type="Script" path="res://StateMachines/Enemy/States/Enemy_Follow.gd" id="8_27t0j"]
[ext_resource type="Script" path="res://StateMachines/Enemy/States/Enemy_Attack.gd" id="9_keaip"]
[ext_resource type="Script" path="res://StateMachines/Enemy/States/Enemy_Retreat.gd" id="10_2u20i"]
[ext_resource type="Script" path="res://StateMachines/Enemy/States/Hit.gd" id="11_4tf71"]
[ext_resource type="Script" path="res://enemy/Enemy_Inactive.gd" id="11_rwiur"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_x8y0j"]

[sub_resource type="BoxShape3D" id="BoxShape3D_m7tor"]
size = Vector3(1, 2, 1)

[sub_resource type="SphereShape3D" id="SphereShape3D_164af"]
radius = 23.8479

[sub_resource type="SphereShape3D" id="SphereShape3D_bp8xu"]
radius = 0.508685

[node name="Enemy" type="CharacterBody3D" node_paths=PackedStringArray("sound_effects") groups=["enemy"]]
script = ExtResource("1_pi25j")
health_points = null
damage_points = null
sound_effects = NodePath("SoundEffects")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_x8y0j")

[node name="Hitbox" type="Area3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
collision_layer = 4
collision_mask = 4

[node name="CollisionShape3D" type="CollisionShape3D" parent="Hitbox"]
shape = SubResource("BoxShape3D_m7tor")

[node name="Player_Detection" type="Area3D" parent="."]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Player_Detection"]
shape = SubResource("SphereShape3D_164af")

[node name="Damage_Detection" type="Area3D" parent="."]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Damage_Detection"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, -0.5)
shape = SubResource("SphereShape3D_bp8xu")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
path_height_offset = 0.5

[node name="Face_Direction" type="Node3D" parent="."]

[node name="SoundEffects" type="AudioStreamPlayer3D" parent="."]
max_polyphony = 2
bus = &"SoundEffects"
script = ExtResource("2_jaulv")

[node name="WalkingSounds" type="AudioStreamPlayer3D" parent="."]
pitch_scale = 1.4
bus = &"SoundEffects"
script = ExtResource("3_ruucy")

[node name="Enemy_Mesh" parent="." instance=ExtResource("5_bficc")]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)

[node name="Skeleton3D" parent="Enemy_Mesh/Armature" index="0"]
bones/0/position = Vector3(-1.9039, 0.594642, -97.9716)
bones/0/rotation = Quaternion(-0.722554, -0.000219252, -0.0137321, 0.691179)
bones/1/rotation = Quaternion(-0.0499069, -0.00267636, 0.00230388, 0.998748)
bones/2/rotation = Quaternion(0.0123821, -0.0276582, 0.00196204, 0.999539)
bones/3/rotation = Quaternion(0.0696063, -0.0274051, 0.00425115, 0.997189)
bones/4/rotation = Quaternion(0.0110642, 0.0184877, -0.00812232, 0.999735)
bones/5/rotation = Quaternion(0.0775334, 0.00443194, 0.0364974, 0.996312)
bones/6/rotation = Quaternion(-0.43121, -0.560089, 0.576042, -0.41053)
bones/7/rotation = Quaternion(0.540516, 0.244851, 0.213967, 0.775957)
bones/8/rotation = Quaternion(7.18134e-07, -1.38925e-07, 0.267946, 0.963434)
bones/9/rotation = Quaternion(0.0870701, 0.0243335, -0.114611, 0.989288)
bones/10/rotation = Quaternion(0.169333, -0.0875311, 0.117343, 0.974626)
bones/11/rotation = Quaternion(-0.0227411, 0.00199333, -0.124155, 0.992)
bones/12/position = Vector3(-1.13249e-06, 4.38211, -2.21665e-05)
bones/12/rotation = Quaternion(-0.0255396, 0.000196098, -0.00763765, 0.999645)
bones/13/rotation = Quaternion(0.191918, -0.00497746, 0.000767487, 0.981398)
bones/14/rotation = Quaternion(0.324951, -0.000201252, -0.0398008, 0.944893)
bones/15/rotation = Quaternion(0.0911288, 0.000278598, -0.00794961, 0.995807)
bones/16/rotation = Quaternion(0.241146, 0.00211626, -0.0267654, 0.970118)
bones/17/rotation = Quaternion(0.219116, -0.00123225, -0.0319273, 0.975175)
bones/18/position = Vector3(2.59166e-05, 2.94611, -1.85492e-06)
bones/18/rotation = Quaternion(0.0728083, 2.0931e-05, -0.00849968, 0.99731)
bones/19/rotation = Quaternion(0.31917, 0.00151987, -0.0287024, 0.947262)
bones/20/position = Vector3(9.54749e-07, 3.24178, -2.90282e-06)
bones/20/rotation = Quaternion(0.11669, -0.000617281, -0.0193374, 0.99298)
bones/21/rotation = Quaternion(0.0294715, -7.76326e-05, -0.00619008, 0.999546)
bones/22/rotation = Quaternion(0.342976, 0.00395836, -0.062314, 0.937267)
bones/23/position = Vector3(1.86872e-06, 3.28085, 4.89514e-07)
bones/23/rotation = Quaternion(0.172813, 0.00733154, 0.0218124, 0.984686)
bones/24/rotation = Quaternion(-0.0316771, -0.000460999, 0.0183806, 0.999329)
bones/25/rotation = Quaternion(0.486929, -0.527333, 0.533059, 0.44796)
bones/26/rotation = Quaternion(0.536562, -0.198441, -0.212804, 0.792109)
bones/27/rotation = Quaternion(2.39414e-07, 1.38453e-07, -0.264837, 0.964293)
bones/28/position = Vector3(1.4828e-05, 27.6145, 5.03783e-06)
bones/28/rotation = Quaternion(-0.0106971, 0.0308847, 0.132605, 0.99063)
bones/29/rotation = Quaternion(0.177235, 0.0479192, -0.107553, 0.9771)
bones/30/position = Vector3(3.9935e-06, 4.74495, -1.32293e-05)
bones/30/rotation = Quaternion(-0.00501337, -0.0362926, 0.110387, 0.993213)
bones/31/rotation = Quaternion(-0.0298536, -0.000759708, 0.00438533, 0.999544)
bones/32/position = Vector3(2.82204, 12.2666, 0.23183)
bones/32/rotation = Quaternion(0.0770935, -0.00240735, 0.0408702, 0.996183)
bones/33/rotation = Quaternion(0.337076, 1.56521e-06, 0.0410823, 0.940581)
bones/34/position = Vector3(-1.5903e-05, 3.41515, 1.17722e-06)
bones/34/rotation = Quaternion(0.0799064, -4.82669e-08, 0.00973807, 0.996755)
bones/35/rotation = Quaternion(0.136349, -0.000962415, 0.0266592, 0.990302)
bones/36/rotation = Quaternion(0.289524, 2.28508e-07, 0.0352836, 0.95652)
bones/37/rotation = Quaternion(0.0658212, 0.00848422, 0.00849414, 0.997759)
bones/38/position = Vector3(-2.21663, 12.147, -0.00999336)
bones/38/rotation = Quaternion(0.208063, 0.00555908, 0.00265906, 0.978096)
bones/39/rotation = Quaternion(0.217337, 2.01129e-06, 0.0264943, 0.975737)
bones/40/rotation = Quaternion(0.0502653, 0.010085, 0.00651027, 0.998664)
bones/41/position = Vector3(-4.72583, 10.9082, 0.226139)
bones/41/rotation = Quaternion(0.265497, 0.0124352, -0.0112904, 0.963965)
bones/42/rotation = Quaternion(0.193429, 2.15442e-06, 0.023583, 0.980831)
bones/43/position = Vector3(-3.17311e-08, 2.59484, 3.763e-06)
bones/43/rotation = Quaternion(0.0280499, -3.76446e-07, 0.00340777, 0.999601)
bones/44/rotation = Quaternion(0.0406431, 0.0665035, 0.995962, -0.0445631)
bones/45/rotation = Quaternion(-0.212774, -0.070636, 0.0200026, 0.97434)
bones/46/rotation = Quaternion(0.616126, -0.0334913, -0.0065302, 0.786909)
bones/47/rotation = Quaternion(0.22942, -0.0325168, -0.0153341, 0.972663)
bones/48/rotation = Quaternion(-0.09405, 0.0570412, 0.99352, 0.0286146)
bones/49/rotation = Quaternion(-0.191421, 0.0315757, -0.0089753, 0.980959)
bones/50/rotation = Quaternion(0.606987, 0.030057, -0.00234386, 0.79414)
bones/51/rotation = Quaternion(0.227113, 0.03326, 0.015554, 0.973176)

[node name="BoneAttachment3D" parent="Enemy_Mesh/Armature/Skeleton3D" index="2"]
transform = Transform3D(0.996198, -0.0755899, -0.0433185, 0.0571561, 0.191777, 0.979773, -0.0657534, -0.978523, 0.195369, -1.81393, 0.358838, -157.989)

[node name="BoneAttachment3D2" parent="Enemy_Mesh/Armature/Skeleton3D" index="3"]
transform = Transform3D(0.431455, 0.30483, -0.849074, -0.888539, -0.0191911, -0.458399, -0.156028, 0.952213, 0.262573, 17.1141, -5.4475, -141.64)

[node name="BoneAttachment3D4" parent="Enemy_Mesh/Armature/Skeleton3D" index="4"]
transform = Transform3D(0.360456, -0.297389, 0.8841, 0.926674, 0.00593069, -0.375819, 0.106521, 0.954738, 0.27772, -20.2908, -6.86383, -141.233)

[node name="BoneAttachment3D3" parent="Enemy_Mesh/Armature/Skeleton3D" index="5"]
transform = Transform3D(-0.96369, 0.0388993, 0.264173, 0.246105, -0.254458, 0.935245, 0.103601, 0.966301, 0.235645, 10.2376, 7.60452, -51.2582)

[node name="BoneAttachment3D5" parent="Enemy_Mesh/Armature/Skeleton3D" index="6"]
transform = Transform3D(-0.969006, -0.0228069, -0.245982, -0.234772, -0.224828, 0.945692, -0.076872, 0.974131, 0.212505, -14.5895, 7.22916, -51.5329)

[node name="EnemyStateMachine" type="Node" parent="."]
script = ExtResource("6_rfg1c")
initial_state = NodePath("Inactive")

[node name="Idle" type="Node" parent="EnemyStateMachine"]
script = ExtResource("7_y3mie")

[node name="Follow" type="Node" parent="EnemyStateMachine"]
script = ExtResource("8_27t0j")

[node name="Attack" type="Node" parent="EnemyStateMachine"]
script = ExtResource("9_keaip")

[node name="Retreat" type="Node" parent="EnemyStateMachine"]
script = ExtResource("10_2u20i")

[node name="Inactive" type="Node" parent="EnemyStateMachine"]
script = ExtResource("11_rwiur")

[node name="Hit" type="Node" parent="EnemyStateMachine"]
script = ExtResource("11_4tf71")

[node name="Timer" type="Timer" parent="."]
wait_time = 2.0

[connection signal="attack" from="." to="Enemy_Mesh/AnimationTree" method="SetAttack"]
[connection signal="attack2" from="." to="Enemy_Mesh/AnimationTree" method="SetAttack2"]
[connection signal="hit" from="." to="Enemy_Mesh/AnimationTree" method="SetHit"]
[connection signal="on_died" from="." to="Enemy_Mesh/AnimationTree" method="Kill"]
[connection signal="running" from="." to="Enemy_Mesh/AnimationTree" method="SetRunning"]
[connection signal="animation_signal" from="Enemy_Mesh" to="." method="_on_enemy_mesh_animation_signal"]
[connection signal="animation_finished" from="Enemy_Mesh/AnimationTree" to="." method="_on_anim_finished"]
[connection signal="timeout" from="Timer" to="." method="reset_stagger"]

[editable path="Enemy_Mesh"]
